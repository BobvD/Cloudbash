<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Upload files to Amazon Simple Storage Service (S3) with Presigned Urls | Cloudbash</title>
    <meta name="description" content="Event Sourced Serverless Architecture">
    <meta name="generator" content="VuePress 1.4.0">
    
    
    <link rel="preload" href="/Cloudbash/assets/css/0.styles.28f9d999.css" as="style"><link rel="preload" href="/Cloudbash/assets/js/app.2099ae3a.js" as="script"><link rel="preload" href="/Cloudbash/assets/js/2.9a52345c.js" as="script"><link rel="preload" href="/Cloudbash/assets/js/9.376c2e87.js" as="script"><link rel="prefetch" href="/Cloudbash/assets/js/10.d03906fd.js"><link rel="prefetch" href="/Cloudbash/assets/js/11.7748677d.js"><link rel="prefetch" href="/Cloudbash/assets/js/12.c7a660ea.js"><link rel="prefetch" href="/Cloudbash/assets/js/13.315a3d5a.js"><link rel="prefetch" href="/Cloudbash/assets/js/14.7439d13a.js"><link rel="prefetch" href="/Cloudbash/assets/js/15.e4b67b56.js"><link rel="prefetch" href="/Cloudbash/assets/js/16.2c0c9060.js"><link rel="prefetch" href="/Cloudbash/assets/js/17.b69ee0eb.js"><link rel="prefetch" href="/Cloudbash/assets/js/18.dcc12843.js"><link rel="prefetch" href="/Cloudbash/assets/js/19.9381a260.js"><link rel="prefetch" href="/Cloudbash/assets/js/3.d94af869.js"><link rel="prefetch" href="/Cloudbash/assets/js/4.39e57b2c.js"><link rel="prefetch" href="/Cloudbash/assets/js/5.c774de42.js"><link rel="prefetch" href="/Cloudbash/assets/js/6.befa6131.js"><link rel="prefetch" href="/Cloudbash/assets/js/7.e64150d9.js"><link rel="prefetch" href="/Cloudbash/assets/js/8.c09ba7f1.js">
    <link rel="stylesheet" href="/Cloudbash/assets/css/0.styles.28f9d999.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/Cloudbash/" class="home-link router-link-active"><img src="https://cloudbash-frontend.s3.amazonaws.com/cloudbash_rgb.svg" alt="Cloudbash" class="logo"> <span class="site-name can-hide">Cloudbash</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://d2bgpsr44efzwn.cloudfront.net/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Home
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/BobvD/Cloudbash" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Live Example
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/BobvD/Cloudbash" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://d2bgpsr44efzwn.cloudfront.net/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Home
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/BobvD/Cloudbash" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Live Example
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/BobvD/Cloudbash" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/Cloudbash/introduction/" class="sidebar-link">Introduction</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Cloudbash/introduction/#about" class="sidebar-link">About</a></li><li class="sidebar-sub-header"><a href="/Cloudbash/introduction/#technical-stack" class="sidebar-link">Technical stack</a></li><li class="sidebar-sub-header"><a href="/Cloudbash/introduction/#getting-started" class="sidebar-link">Getting started</a></li><li class="sidebar-sub-header"><a href="/Cloudbash/introduction/#cloudbash-cli" class="sidebar-link">Cloudbash CLI</a></li></ul></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Event Sourcing &amp; CQRS</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Cloudbash/event_sourcing/" class="sidebar-link">Introduction</a></li><li><a href="/Cloudbash/domain_driven_design/" class="sidebar-link">Domain Driven Design</a></li><li><a href="/Cloudbash/event_sourcing/implementation.html" class="sidebar-link">Implementation in .NET Core</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>ES Serverless Architecture</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Cloudbash/serverless_architecture/" class="sidebar-link">Introduction</a></li><li><a href="/Cloudbash/event_sourcing/implementation.html" class="sidebar-link">Implementation in .NET Core</a></li></ul></section></li><li><a href="/Cloudbash/business_scenario/" class="sidebar-link">Business Scenario and Analysis</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Cloudbash/business_scenario/#in-a-nutshell" class="sidebar-link">In a Nutshell...</a></li><li class="sidebar-sub-header"><a href="/Cloudbash/business_scenario/#story-mapping" class="sidebar-link">Story Mapping</a></li><li class="sidebar-sub-header"><a href="/Cloudbash/business_scenario/#user-stories" class="sidebar-link">User Stories</a></li><li class="sidebar-sub-header"><a href="/Cloudbash/business_scenario/#event-storming-wip" class="sidebar-link">Event Storming (WIP)</a></li><li class="sidebar-sub-header"><a href="/Cloudbash/business_scenario/#bounded-contexts" class="sidebar-link">Bounded Contexts</a></li><li class="sidebar-sub-header"><a href="/Cloudbash/business_scenario/#class-diagrams" class="sidebar-link">Class Diagrams</a></li></ul></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Serverless Web development</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Cloudbash/aws_serverless/serverless_functions.html" class="sidebar-link">Restful API</a></li><li><a href="/Cloudbash/aws_serverless/static_website_hosting.html" class="sidebar-link">Static Website Hosting</a></li><li><a href="/Cloudbash/aws_serverless/s3_file_uploads.html" class="active sidebar-link">S3 File Uploads</a></li><li><a href="/Cloudbash/aws_serverless/cognito_auth.html" class="sidebar-link">Access Control with Cognito</a></li><li><a href="/Cloudbash/aws_serverless/data_lake.html" class="sidebar-link">Data Lake with S3, Glue &amp; Athena</a></li></ul></section></li><li><a href="/Cloudbash/dev_ops/" class="sidebar-link">Dev Ops</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Cloudbash/dev_ops/#serverless-framework" class="sidebar-link">Serverless Framework</a></li><li class="sidebar-sub-header"><a href="/Cloudbash/dev_ops/#aws-codepipeline" class="sidebar-link">AWS CodePipeLine</a></li><li class="sidebar-sub-header"><a href="/Cloudbash/dev_ops/#github-actions" class="sidebar-link">GitHub Actions</a></li><li class="sidebar-sub-header"><a href="/Cloudbash/dev_ops/#load-testing" class="sidebar-link">Load Testing</a></li></ul></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="upload-files-to-amazon-simple-storage-service-s3-with-presigned-urls"><a href="#upload-files-to-amazon-simple-storage-service-s3-with-presigned-urls" class="header-anchor">#</a> Upload files to Amazon Simple Storage Service (S3) with Presigned Urls</h1> <figure><img src="/Cloudbash/assets/img/s3_upload.3d0b8d85.png"> <figcaption></figcaption></figure>
Presigned URLs can be used as a simple and secure way to upload (large) files to an S3 Bucket. The URL is generated using IAM credentials with permission to write to the bucket.  
<p>The presigned URL has an expiration time, the upload needs to be started before this time, or it will be denied. You can use the URL only once. When generating the URL you also need to provide the target bucket and name of the object (key) you want to upload.</p> <p>It is possible to manually generate Pre-signed URLs with the AWS CLI, but for our implementation we will be using the AWS SDK to generate urls when this is requested by an user of our angular application.</p> <h2 id="server-side-code"><a href="#server-side-code" class="header-anchor">#</a> Server-side code</h2> <p><strong>GetS3PreSignedUrlFunction.cs</strong> - <a href="https://github.com/BobvD/Cloudbash/blob/dev/src/Lambda/Functions/Files/GetS3PreSignedURLFunction.cs" target="_blank" rel="noopener noreferrer">source<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> <br>
The code for our Lambda Endpoint. It will return the Presigned URL on success or an error message on failure.
We use the <a href="https://github.com/jbogard/MediatR" target="_blank" rel="noopener noreferrer">Mediator<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> pattern to decouple the presentation and application layer.</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">LambdaSerializer</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token keyword">typeof</span><span class="token punctuation">(</span><span class="token type-expression class-name">Amazon<span class="token punctuation">.</span>Lambda<span class="token punctuation">.</span>Serialization<span class="token punctuation">.</span>Json<span class="token punctuation">.</span>JsonSerializer</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token return-type class-name">Task<span class="token punctuation">&lt;</span>APIGatewayProxyResponse<span class="token punctuation">&gt;</span></span> <span class="token function">Run</span><span class="token punctuation">(</span><span class="token class-name">APIGatewayProxyRequest</span> request<span class="token punctuation">)</span>
<span class="token punctuation">{</span>           
    <span class="token class-name"><span class="token keyword">var</span></span> requestModel <span class="token operator">=</span> 
        JsonConvert<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">DeserializeObject</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>GetS3PreSignedUrlCommand<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>Body<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">try</span>
    <span class="token punctuation">{</span>               
        <span class="token class-name"><span class="token keyword">var</span></span> result <span class="token operator">=</span> <span class="token keyword">await</span> Mediator<span class="token punctuation">.</span><span class="token function">Send</span><span class="token punctuation">(</span>requestModel<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">APIGatewayProxyResponse</span>
        <span class="token punctuation">{</span>
            Headers <span class="token operator">=</span> <span class="token function">GetCorsHeaders</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            StatusCode <span class="token operator">=</span> <span class="token number">201</span><span class="token punctuation">,</span>
            Body <span class="token operator">=</span> JsonConvert<span class="token punctuation">.</span><span class="token function">SerializeObject</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> ex<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">APIGatewayProxyResponse</span>
        <span class="token punctuation">{</span>
            Headers <span class="token operator">=</span> <span class="token function">GetCorsHeaders</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            StatusCode <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">,</span>
            Body <span class="token operator">=</span> JsonConvert<span class="token punctuation">.</span><span class="token function">SerializeObject</span><span class="token punctuation">(</span>ex<span class="token punctuation">.</span>Message<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>GetS3PreSignedUrlCommand.cs</strong> - <a href="https://github.com/BobvD/Cloudbash/blob/dev/src/Application/Files/Commands/GenerateS3PreSignedUrl/GetS3PreSignedUrlCommand.cs" target="_blank" rel="noopener noreferrer">source<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> <br>
The Command and its Handler. The type- and name of the file need to be specified for a succesfull call. The FileService, containing the AWS SDK logic, is provided with help of dependecy injection.</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GetS3PreSignedUrlCommand</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">IRequest<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> Filename <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> Type <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GetS3PreSignedUrlCommandHandler</span> 
        <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">IRequestHandler<span class="token punctuation">&lt;</span>GetS3PreSignedUrlCommand<span class="token punctuation">,</span> <span class="token keyword">string</span><span class="token punctuation">&gt;</span></span></span>
    <span class="token punctuation">{</span>

        <span class="token keyword">private</span> <span class="token class-name">IFileService</span> _fileService<span class="token punctuation">;</span>

        <span class="token keyword">public</span> <span class="token function">GetS3PreSignedUrlCommandHandler</span><span class="token punctuation">(</span><span class="token class-name">IFileService</span> fileService<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            _fileService <span class="token operator">=</span> fileService<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token return-type class-name">Task<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> <span class="token function">Handle</span><span class="token punctuation">(</span><span class="token class-name">GetS3PreSignedUrlCommand</span> request<span class="token punctuation">,</span> 
                                            <span class="token class-name">CancellationToken</span> cancellationToken<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">return</span> _fileService<span class="token punctuation">.</span><span class="token function">GetUploadUrl</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>Filename<span class="token punctuation">,</span> request<span class="token punctuation">.</span>Type<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>S3FileService.cs</strong> - <a href="https://github.com/BobvD/Cloudbash/blob/dev/src/Infrastructure/Services/S3FileService.cs" target="_blank" rel="noopener noreferrer">source<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> <br>
The S3FileService makes use of the <a href="https://www.nuget.org/packages/AWSSDK.S3/3.5.0-beta" target="_blank" rel="noopener noreferrer">AWS S3 SDK<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">S3FileService</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">IFileService</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">readonly</span> <span class="token class-name">AmazonS3Client</span> _amazonS3Client<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">readonly</span> <span class="token class-name">IServerlessConfiguration</span> _config<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token function">S3FileService</span><span class="token punctuation">(</span><span class="token class-name">IAwsClientFactory<span class="token punctuation">&lt;</span>AmazonS3Client<span class="token punctuation">&gt;</span></span> clientFactory<span class="token punctuation">,</span>
                                <span class="token class-name">IServerlessConfiguration</span> config<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        _amazonS3Client <span class="token operator">=</span> clientFactory<span class="token punctuation">.</span><span class="token function">GetAwsClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        _config <span class="token operator">=</span> config<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token function">GetUploadUrl</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> filename<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> type<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword">var</span></span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">GetPreSignedUrlRequest</span>
        <span class="token punctuation">{</span>
            BucketName <span class="token operator">=</span> _config<span class="token punctuation">.</span>BucketName<span class="token punctuation">,</span>
            Key <span class="token operator">=</span> filename<span class="token punctuation">,</span>
            Verb <span class="token operator">=</span> HttpVerb<span class="token punctuation">.</span>PUT<span class="token punctuation">,</span>
            ContentType <span class="token operator">=</span> type<span class="token punctuation">,</span>
            Expires <span class="token operator">=</span> DateTime<span class="token punctuation">.</span>Now<span class="token punctuation">.</span><span class="token function">AddMinutes</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> _amazonS3Client<span class="token punctuation">.</span><span class="token function">GetPreSignedURL</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>           
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="client-side-code"><a href="#client-side-code" class="header-anchor">#</a> Client-side code</h2> <p><strong>file.service.ts</strong> - <a href="https://github.com/BobvD/Cloudbash/blob/dev/src/WebUI/src/app/shared/services/file.service.ts" target="_blank" rel="noopener noreferrer">source<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> <br>
The FileService contains methods that make use of Angular's HttpClient to make http calls. The <em>getS3PresignedUrl()</em> method makes an HTTP Post call to our Lamdbda, requesting a presigned URL. The <em>uploadFileToS3()</em> can make use of these urls to make a PUT request, uploading the file. It listens for reported progress, and return this as an percentage (1-100) for display on the web page.</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code>@<span class="token function">Injectable</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">FileService</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> _filesURL<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  
    <span class="token keyword">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">private</span> http<span class="token operator">:</span> HttpClient</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>_filesURL <span class="token operator">=</span> localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">'apiUrl'</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'/files/'</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token function">uploadFileToS3</span><span class="token punctuation">(</span>file<span class="token operator">:</span> File<span class="token punctuation">,</span> signedURL<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> Observable<span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
        
        <span class="token keyword">const</span> headers <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HttpHeaders</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        headers<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">'Content-Type'</span><span class="token punctuation">,</span> file<span class="token punctuation">.</span><span class="token keyword">type</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        headers<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;x-amz-acl&quot;</span><span class="token punctuation">,</span> <span class="token string">'public-read'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>http<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>signedURL<span class="token punctuation">,</span> file<span class="token punctuation">,</span> 
                                <span class="token punctuation">{</span> headers<span class="token punctuation">,</span> reportProgress<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> observe<span class="token operator">:</span> <span class="token string">'events'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> 
        <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">switch</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span><span class="token keyword">type</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      
              <span class="token keyword">case</span> HttpEventType<span class="token punctuation">.</span>UploadProgress<span class="token operator">:</span>
                <span class="token keyword">const</span> progress <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">round</span><span class="token punctuation">(</span><span class="token number">100</span> <span class="token operator">*</span> event<span class="token punctuation">.</span>loaded <span class="token operator">/</span> event<span class="token punctuation">.</span>total<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> <span class="token punctuation">{</span> status<span class="token operator">:</span> <span class="token string">'progress'</span><span class="token punctuation">,</span> message<span class="token operator">:</span> progress <span class="token punctuation">}</span><span class="token punctuation">;</span>
      
              <span class="token keyword">case</span> HttpEventType<span class="token punctuation">.</span>Response<span class="token operator">:</span>
                <span class="token keyword">return</span> event<span class="token punctuation">.</span>body<span class="token punctuation">;</span>
              <span class="token keyword">default</span><span class="token operator">:</span>
                <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Unhandled event: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>event<span class="token punctuation">.</span><span class="token keyword">type</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>            
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token function">getS3PresignedUrl</span><span class="token punctuation">(</span>filename<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token keyword">type</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">:</span> Observable<span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>        
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>http<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>_filesURL <span class="token operator">+</span> <span class="token string">'get_upload_url'</span><span class="token punctuation">,</span> 
                                <span class="token punctuation">{</span> Filename<span class="token operator">:</span> filename<span class="token punctuation">,</span> Type<span class="token operator">:</span> <span class="token keyword">type</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>       

<span class="token punctuation">}</span>
</code></pre></div><p><strong>file-upload.component.ts</strong> - <a href="https://github.com/BobvD/Cloudbash/blob/dev/src/WebUI/src/app/shared/components/file-upload/file-upload.component.ts" target="_blank" rel="noopener noreferrer">source<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> <br>
The File Upload component contains a HTML file input element, a bootstrap-style progress bar and a button that will call the <em>onSubmit()</em> function. When this function is called, it will first make the HTTP request to our Lambda for an presigned URL. When successfully retrieved, it will use this URL to upload the file to the S3 bucket.</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Component<span class="token punctuation">,</span> OnInit<span class="token punctuation">,</span> ElementRef<span class="token punctuation">,</span> ViewChild <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/core'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> FormBuilder<span class="token punctuation">,</span> FormGroup<span class="token punctuation">,</span> Validators <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/forms'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> FileService <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../../services/file.service'</span><span class="token punctuation">;</span>

@<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    selector<span class="token operator">:</span> <span class="token string">'app-file-upload'</span><span class="token punctuation">,</span>
    templateUrl<span class="token operator">:</span> <span class="token string">'./file-upload.component.html'</span><span class="token punctuation">,</span>
    styleUrls<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'./file-upload.component.scss'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">FileUploadComponent</span> <span class="token keyword">implements</span> <span class="token class-name">OnInit</span> <span class="token punctuation">{</span>
    @<span class="token function">ViewChild</span><span class="token punctuation">(</span><span class="token string">'formEl'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token keyword">static</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> formEl<span class="token operator">:</span> ElementRef<span class="token punctuation">;</span>
    <span class="token keyword">public</span> form<span class="token operator">:</span> FormGroup<span class="token punctuation">;</span>
    <span class="token keyword">public</span> fileToUpload<span class="token operator">:</span> File<span class="token punctuation">;</span>

    uploadResponse <span class="token operator">=</span> <span class="token punctuation">{</span> status<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span> message<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span> filePath<span class="token operator">:</span> <span class="token string">''</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    error<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

    <span class="token keyword">constructor</span><span class="token punctuation">(</span>
        <span class="token parameter"><span class="token keyword">private</span> formBuilder<span class="token operator">:</span> FormBuilder<span class="token punctuation">,</span>
        <span class="token keyword">private</span> fileService<span class="token operator">:</span> FileService</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>

    <span class="token function">ngOnInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">createForm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">createForm</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>form <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>formBuilder<span class="token punctuation">.</span><span class="token function">group</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            fileUpload<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token keyword">null</span><span class="token punctuation">,</span> Validators<span class="token punctuation">.</span>required<span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token function">onFilesSelection</span><span class="token punctuation">(</span>$event<span class="token operator">:</span> Event<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> target <span class="token operator">=</span> $event<span class="token punctuation">.</span>target <span class="token operator">||</span> $event<span class="token punctuation">.</span>srcElement<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>fileToUpload <span class="token operator">=</span> target<span class="token punctuation">[</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">files</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">onSubmit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>fileService<span class="token punctuation">.</span><span class="token function">getS3PresignedUrl</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>fileToUpload<span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>fileToUpload<span class="token punctuation">.</span><span class="token keyword">type</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token parameter">url</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>fileService<span class="token punctuation">.</span><span class="token function">uploadFileToS3</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>fileToUpload<span class="token punctuation">,</span> url<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>
                <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>uploadResponse <span class="token operator">=</span> res<span class="token punctuation">,</span>
                <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>error <span class="token operator">=</span> err
            <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

</code></pre></div><p><strong>file-upload.component.html</strong> - <a href="https://github.com/BobvD/Cloudbash/blob/dev/src/WebUI/src/app/shared/components/file-upload/file-upload.component.html" target="_blank" rel="noopener noreferrer">source<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> <br></p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">#formEl</span> <span class="token attr-name">novalidate</span> <span class="token attr-name">(ngSubmit)</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>onSubmit()<span class="token punctuation">&quot;</span></span> <span class="token attr-name">[formGroup]</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>form<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>d-flex<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>fileUpload<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>fileUpload<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>file<span class="token punctuation">&quot;</span></span>  <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>mr-2<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name">[formControlName]</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">'</span>fileUpload'<span class="token punctuation">&quot;</span></span> <span class="token attr-name">(change)</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>onFilesSelection($event)<span class="token punctuation">&quot;</span></span> 
            <span class="token attr-name">accept</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>image/*<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>submit<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>btn btn-secondary<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            Upload image
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">*ngIf</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>uploadResponse.status === 'progress'<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>progress mt-2<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>progress-bar progress-bar-striped<span class="token punctuation">&quot;</span></span> <span class="token attr-name">role</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>progressbar<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">[style.width.%]</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>uploadResponse.message<span class="token punctuation">&quot;</span></span> 
        <span class="token attr-name">aria-valuenow</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>25<span class="token punctuation">&quot;</span></span> <span class="token attr-name">aria-valuemin</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">aria-valuemax</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>100<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        {{uploadResponse.message}}%
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h2 id="further-reading"><a href="#further-reading" class="header-anchor">#</a> Further reading</h2> <ul><li><a href="https://docs.aws.amazon.com/AmazonS3/latest/dev/ShareObjectPreSignedURLDotNetSDK.html" target="_blank" rel="noopener noreferrer">Generate a Presigned Object URL Using AWS SDK for .NET<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> - Official AWS Documentation</li> <li><a href="https://medium.com/@aidan.hallett/securing-aws-s3-uploads-using-presigned-urls-aa821c13ae8d" target="_blank" rel="noopener noreferrer">Securing AWS S3 uploads using presigned Urls<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> by Aidan Hallett</li> <li><a href="https://www.serverless.com/blog/s3-one-time-signed-url/" target="_blank" rel="noopener noreferrer">Uploading objects to S3 using one-time pre signed URLs<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> by Eetu  Tuomala</li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/Cloudbash/aws_serverless/static_website_hosting.html" class="prev">
        Static Website Hosting
      </a></span> <span class="next"><a href="/Cloudbash/aws_serverless/cognito_auth.html">
        Access Control with Cognito
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/Cloudbash/assets/js/app.2099ae3a.js" defer></script><script src="/Cloudbash/assets/js/2.9a52345c.js" defer></script><script src="/Cloudbash/assets/js/9.376c2e87.js" defer></script>
  </body>
</html>
