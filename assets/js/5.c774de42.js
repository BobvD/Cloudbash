(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{166:function(e,a,t){e.exports=t.p+"assets/img/high_level_architecture.92f176e2.png"},261:function(e,a,t){e.exports=t.p+"assets/img/api_lambda_example.84ecb214.png"},262:function(e,a){e.exports="data:image/png;base64,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"},263:function(e,a,t){e.exports=t.p+"assets/img/event_bus.90c4ddf0.png"},280:function(e,a,t){"use strict";t.r(a);var n=t(28),r=Object(n.a)({},(function(){var e=this,a=e.$createElement,n=e._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("This article is written in dutch, a translated version will be posted soon™.\n")])])]),n("h1",{attrs:{id:"event-sourced-serverless-architecture"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#event-sourced-serverless-architecture"}},[e._v("#")]),e._v(" Event-sourced Serverless Architecture")]),e._v(" "),n("p",[n("strong",[e._v("Inhoud")])]),n("div",{staticClass:"table-of-contents"},[n("ul",[n("li",[n("a",{attrs:{href:"#introductie"}},[e._v("Introductie")])]),n("li",[n("a",{attrs:{href:"#waarom"}},[e._v("Waarom?")])]),n("li",[n("a",{attrs:{href:"#architectuur"}},[e._v("Architectuur")])]),n("li",[n("a",{attrs:{href:"#restful-api"}},[e._v("RESTful API")]),n("ul",[n("li",[n("a",{attrs:{href:"#aws-lambda"}},[e._v("AWS Lambda")])]),n("li",[n("a",{attrs:{href:"#aws-api-gateway"}},[e._v("AWS API Gateway")])])])]),n("li",[n("a",{attrs:{href:"#event-log-dynamodb"}},[e._v("Event Log - DynamoDB")]),n("ul",[n("li",[n("a",{attrs:{href:"#dataschema"}},[e._v("Dataschema")])])])]),n("li",[n("a",{attrs:{href:"#event-bus"}},[e._v("Event Bus")]),n("ul",[n("li",[n("a",{attrs:{href:"#dynamodb-streams"}},[e._v("DynamoDB Streams")])]),n("li",[n("a",{attrs:{href:"#simple-message-service"}},[e._v("Simple Message Service")])]),n("li",[n("a",{attrs:{href:"#kinesis-data-streams"}},[e._v("Kinesis Data streams")])]),n("li",[n("a",{attrs:{href:"#welke-aws-service-is-het-meest-geschikt-als-event-bus"}},[e._v("Welke AWS-Service is het meest geschikt als Event Bus?")])])])]),n("li",[n("a",{attrs:{href:"#read-database"}},[e._v("Read Database")]),n("ul",[n("li",[n("a",{attrs:{href:"#dynamodb"}},[e._v("DynamoDB")])]),n("li",[n("a",{attrs:{href:"#elasticache"}},[e._v("ElastiCache")])]),n("li",[n("a",{attrs:{href:"#relation-database-service-rds"}},[e._v("Relation Database Service (RDS)")])])])])])]),n("p"),e._v(" "),n("h2",{attrs:{id:"introductie"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#introductie"}},[e._v("#")]),e._v(" Introductie")]),e._v(" "),n("p",[e._v("Dit project demonstreert hoe een event-sourced applicatie kan worden opgezet binnen een serverless architectuur op Amazon Web Services (AWS). Bij een serverless architectuur wordt de software volledig gemanaged door de "),n("em",[e._v("Cloud provider")]),e._v(". De ontwikkelaar hoeft zich hierdoor minder zorgen te maken over de infrastructuur en kan zich focussen op het schrijven van code.")]),e._v(" "),n("p",[e._v("Serverless applicaties op AWS bestaan uit een combinatie van "),n("em",[e._v("Lambda")]),e._v("-functies en andere AWS-services. AWS Lambda is een compute dienst die code kan uitvoeren als reactie op een "),n("em",[e._v("event")]),e._v(" ontvangen uit een andere AWS-service of bijvoorbeeld na een HTTP-request.")]),e._v(" "),n("h2",{attrs:{id:"waarom"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#waarom"}},[e._v("#")]),e._v(" Waarom?")]),e._v(" "),n("p",[e._v("De veronderstelling is dat de voordelen die "),n("em",[e._v("event sourcing")]),e._v(" kan bieden krachtig zijn in samenwerking met de voordelen van serverless architecturen.")]),e._v(" "),n("ul",[n("li",[e._v("Schaalbaarheid, een combinatie van event sourcing en CQRS biedt een hoge vorm van schaalbaarheid. Door gebruikt te maken van AWS wordt het schalen van je applicatie uit handen genomen. Lambda functies kunnen uit zichzelf schalen ("),n("em",[e._v("auto scaling)")]),e._v(". Wanneer een instantie van een functie bezig is met het afwerken van een request, zal een tweede instantie vanzelf opstarten. Niet alleen Lambda functies zijn schaalbaar, ook andere services, onder meer databases en message queues, bieden hier ondersteuning voor.")]),e._v(" "),n("li",[e._v("Lambda functies kunnen snel ontwikkeld worden, omdat er alleen code hoeft aangeleverd te worden. Er kan dus snel nieuwe functionaliteit worden ontwikkeld op basis van verzamelde events in het event log.")]),e._v(" "),n("li",[e._v("Op basis van het event log kan een schat aan reportages gegenereerd worden. AWS heeft verschillende services die met deze data kunnen werken. Bijvoorbeeld om deze te visualiseren voor business analisten of om diverse varianten van machine learning uitvoeren.")])]),e._v(" "),n("h2",{attrs:{id:"architectuur"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#architectuur"}},[e._v("#")]),e._v(" Architectuur")]),e._v(" "),n("p",[e._v("De  applicatie, kent de volgende architectuur, zoals eerder beschreven in "),n("RouterLink",{attrs:{to:"/serverless_architecture/event_sourcing/"}},[e._v("het artikel")]),e._v(" over Event Sourcing en CQRS.")],1),e._v(" "),n("figure",[n("img",{attrs:{src:t(166)}}),e._v(" "),n("figcaption")]),e._v(" "),n("p",[e._v("Er kan met de applicatie, gecommuniceerd worden doormiddel van een "),n("em",[e._v("REST API")]),e._v(". De applicatie maakt gebruik van een "),n("em",[e._v("CQRS")]),e._v(", er is een schrijfkant kant die data wegschrijft naar het "),n("em",[e._v("Event Log")]),e._v(" en een leeskant die data opvraagt uit een database. Communicatie tussen de verschillende onderdelen van de applicatie gebeurt via een "),n("em",[e._v("Message Bus")]),e._v(".")]),e._v(" "),n("p",[e._v("De applicatie bestaat dus uit 4 belangrijke componenten waarvoor een serverless oplossing moest worden gevonden:")]),e._v(" "),n("ol",[n("li",[e._v("REST API")]),e._v(" "),n("li",[e._v("Event Log")]),e._v(" "),n("li",[e._v("Message Bus (Event Bus)")]),e._v(" "),n("li",[e._v("Lees Database")])]),e._v(" "),n("h2",{attrs:{id:"restful-api"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#restful-api"}},[e._v("#")]),e._v(" RESTful API")]),e._v(" "),n("p",[e._v("Het REST API component van de applicatie is ontwikkeld met de volgende AWS-services:")]),e._v(" "),n("figure",[n("img",{attrs:{src:t(261)}}),e._v(" "),n("figcaption")]),e._v(" "),n("h3",{attrs:{id:"aws-lambda"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#aws-lambda"}},[e._v("#")]),e._v(" AWS Lambda")]),e._v(" "),n("p",[e._v("Zoals eerder beschreven is Lambda de Cloud compute service van Amazon Web Services. Voor ieder "),n("em",[e._v("endpoint")]),e._v(" van de REST API is een Lambda-functie opgezet die de vereiste functionaliteit implementeert. Zie het artikel "),n("RouterLink",{attrs:{to:"/aws_serverless/serverless_functions.html"}},[e._v("'RESTful APIs with API Gateway & Lambda'")]),e._v(", voor een voorbeeld van de implementatie van een Lambda-functie in .NET Core. De "),n("a",{attrs:{href:"https://aws.amazon.com/lambda/pricing/",target:"_blank",rel:"noopener noreferrer"}},[e._v("kosten van een Lambda"),n("OutboundLink")],1),e._v(" worden berekend aan de hand van het aantal requests in combinatie met het geheugengebruik en de duur van het draaien van de functie. Bij het 3 miljoen keer aanroepen van een functie die 512MB geheugen gebruikt en 1 seconde duurt zullen de kosten rond de $18.00 liggen.")],1),e._v(" "),n("h3",{attrs:{id:"aws-api-gateway"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#aws-api-gateway"}},[e._v("#")]),e._v(" AWS API Gateway")]),e._v(" "),n("p",[e._v("API Gateway is een AWS-service voor het maken, monitoren en beveiligen van REST, HTTP en WebSockets APIs.\nDe service maakt het mogelijk om Lambda-functies aan te roepen op basis van HTTP-requests. Voordat deze request wordt doorgezet kan er een vorm van autorisatie worden uitgevoerd, voor een voorbeeld hiervan zie het artikel "),n("RouterLink",{attrs:{to:"/aws_serverless/cognito_auth.html"}},[e._v("'Access Control with AWS Cognito'")]),e._v(". De "),n("a",{attrs:{href:"https://aws.amazon.com/api-gateway/pricing/",target:"_blank",rel:"noopener noreferrer"}},[e._v("kosten van API Gateway"),n("OutboundLink")],1),e._v(" liggen rond de $1.00 per miljoen requests.")],1),e._v(" "),n("h2",{attrs:{id:"event-log-dynamodb"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#event-log-dynamodb"}},[e._v("#")]),e._v(" Event Log - DynamoDB")]),e._v(" "),n("p",[e._v("Amazon DynamoDB is een NoSQL database die volledig beheerd wordt door Amazon Web Services. De database hoeft dus niet geïnstalleerd te worden, maar kan eenvoudig aangemaakt worden via de AWS Console of "),n("a",{attrs:{href:"https://aws.amazon.com/cloudformation/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Cloudformation"),n("OutboundLink")],1),e._v(".")]),e._v(" "),n("h4",{attrs:{id:"waarom-dynamodb-gebruiken-voor-het-event-log"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#waarom-dynamodb-gebruiken-voor-het-event-log"}},[e._v("#")]),e._v(" Waarom DynamoDB gebruiken voor het event log?")]),e._v(" "),n("ul",[n("li",[e._v("Doormiddel van IAM-permissies (Identity en Access Management) is het mogelijk te garanderen dat er alleen naar de database geschreven en gelezen kan worden. Omdat een event log append-only is willen we niet dat er records aangepast of verwijderd kunnen worden.")]),e._v(" "),n("li",[e._v("De rangschikking van records kan worden gegarandeerd door gebruik te maken van een combinatie van "),n("em",[e._v("partition")]),e._v(" (identifier) en "),n("em",[e._v("sort key")]),e._v(" (versie).")]),e._v(" "),n("li",[e._v("DynamoDB streams: een event stream waar met een Lambda-functie naar geluisterd kan worden. Na iedere gebeurtenis in de database wordt een event gegooid. Hier kan op worden ingespeeld, zo kunnen we bijvoorbeeld eenvoudig andere AWS-services aan de DynamoDB database koppelen.")]),e._v(" "),n("li",[e._v("Er zijn geen limieten op de grootte van een tabel. Dit komt goed uit, want event logs kunnen snel groeien.")]),e._v(" "),n("li",[e._v("De schrijf- en leesfunctionaliteit van de database kunnen los van elkaar en automatisch worden opgeschaald.")]),e._v(" "),n("li",[e._v("Back-ups, DynamoDB heeft verschillende mogelijkheden voor het automatisch aanmaken van back ups.")])]),e._v(" "),n("h4",{attrs:{id:"aandachtspunten"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#aandachtspunten"}},[e._v("#")]),e._v(" Aandachtspunten")]),e._v(" "),n("ul",[n("li",[e._v("Items (records) die in de database worden opgeslagen kunnen maximaal 400KB groot zijn.")]),e._v(" "),n("li",[e._v("De kosten van DynamoDB databases kunnen snel stijgen wanneer deze in grootte toenemen. Het is mogelijk om oude data, bijvoorbeeld, weg te schrijven naar S3 en hiermee kosten te verlagen.")])]),e._v(" "),n("h3",{attrs:{id:"dataschema"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#dataschema"}},[e._v("#")]),e._v(" Dataschema")]),e._v(" "),n("figure",{staticStyle:{"text-align":"center"}},[n("img",{attrs:{src:t(262)}})]),e._v(" "),n("table",[n("thead",[n("tr",[n("th",[e._v("Attribuut")]),e._v(" "),n("th",[e._v("Type")]),e._v(" "),n("th",[e._v("Beschrijving")])])]),e._v(" "),n("tbody",[n("tr",[n("td",[e._v("AggregateId")]),e._v(" "),n("td",[e._v("String (Guid)")]),e._v(" "),n("td",[n("em",[e._v("Partition key")]),e._v(" "),n("br"),e._v(" ID van de Aggregate waar het event onder valt.")])]),e._v(" "),n("tr",[n("td",[e._v("AggregateVersion")]),e._v(" "),n("td",[e._v("Number")]),e._v(" "),n("td",[n("em",[e._v("Sort Key")]),e._v(" "),n("br"),e._v(" De versie van de aggregate – combinatie van AggregateId en AggregateVersion is uniek.")])]),e._v(" "),n("tr",[n("td",[e._v("Created")]),e._v(" "),n("td",[e._v("Date")]),e._v(" "),n("td",[e._v("Datum en tijd van het aanmaken van het event.")])]),e._v(" "),n("tr",[n("td",[e._v("Data")]),e._v(" "),n("td",[e._v("String (JSON)")]),e._v(" "),n("td",[e._v("Geserialiseerde JSON-string met de gegevens van het event.")])]),e._v(" "),n("tr",[n("td",[e._v("EventType")]),e._v(" "),n("td",[e._v("String")]),e._v(" "),n("td",[e._v("De naam van het event.")])])])]),e._v(" "),n("p",[n("strong",[e._v("voorbeeld data")])]),e._v(" "),n("div",{staticClass:"language-json extra-class"},[n("pre",{pre:!0,attrs:{class:"language-json"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n"),n("span",{pre:!0,attrs:{class:"token property"}},[e._v('"AggregateId"')]),e._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[e._v('"a8bab764-659b-4873-a8aa-618ed8b199bf"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n"),n("span",{pre:!0,attrs:{class:"token property"}},[e._v('"AggregateVersion"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("3")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n"),n("span",{pre:!0,attrs:{class:"token property"}},[e._v('"Created"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[e._v('"2020-05-25T16:10:56.123Z"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n"),n("span",{pre:!0,attrs:{class:"token property"}},[e._v('"Data"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[e._v('"{\\"CustomerId\\":\\"566316c4-ba88-4c0a-8c3a-0389792a1fe0\\",\\"EventId\\":\\"648c72e1-38f1-431b-8e73-91463ec876db\\",\\"AggregateId\\":\\"a8ea2d86-f091-4abe-895c-4a90f267882a\\",\\"AggregateVersion\\":0}"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n"),n("span",{pre:!0,attrs:{class:"token property"}},[e._v('"EventType"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[e._v('"Cloudbash.Domain.Carts.Events.CartCreatedEvent"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])]),n("h2",{attrs:{id:"event-bus"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#event-bus"}},[e._v("#")]),e._v(" Event Bus")]),e._v(" "),n("p",[e._v("De Event bus verzorgt de communicatie tussen de verschillende componenten van de applicatie.")]),e._v(" "),n("p",[e._v("Een event bus kent één of meerdere "),n("em",[e._v("Publishers")]),e._v(", deze schrijven de events naar de bus, en één of meerder "),n("em",[e._v("Subscribers")]),e._v(" (ook wel consumers genoemd), deze luisteren naar de bus en ontvangen berichten. We kunnen events vanuit een Lambda-functie naar de bus sturen en hier met andere Lambda-functies naar luisteren.")]),e._v(" "),n("figure",{staticStyle:{"text-align":"center"}},[n("img",{attrs:{src:t(263)}})]),e._v(" "),n("p",[e._v("Amazon Web Services bied meerdere services die we kunnen gebruiken als Event Bus. Alle services zijn verschillend in prijs, performance en toepasbaarheid. Voor onze applicatie, Cloudbash, hebben we drie verschillende mogelijkheden onderzocht.")]),e._v(" "),n("h3",{attrs:{id:"dynamodb-streams"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#dynamodb-streams"}},[e._v("#")]),e._v(" DynamoDB Streams")]),e._v(" "),n("p",[e._v("De eenvoudigste manier om een event bus te implementeren is door gebruik te maken van de stream mogelijkheden van het DynamoDB event log. Na ieder event record wat wordt weggeschreven naar dit log zal automatisch een notificatie worden verzonden via "),n("a",{attrs:{href:"https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/Streams.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("DynamoDB streams"),n("OutboundLink")],1),e._v(". Er kan een Lambda worden geschreven die naar deze notificaties luistert.")]),e._v(" "),n("h4",{attrs:{id:"voordelen"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#voordelen"}},[e._v("#")]),e._v(" Voordelen")]),e._v(" "),n("ul",[n("li",[e._v("Eenvoudige oplossing, er zijn geen extra AWS-services nodig. Ook is het simpel om een Lambda aan deze stream te koppelen en events uit te lezen.")]),e._v(" "),n("li",[e._v("De streams schalen, net zoals de DynamoDB database, vanzelf.")]),e._v(" "),n("li",[e._v("Het luisteren met een Lambda naar een stream is gratis.")])]),e._v(" "),n("h4",{attrs:{id:"aandachtspunten-2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#aandachtspunten-2"}},[e._v("#")]),e._v(" Aandachtspunten")]),e._v(" "),n("ul",[n("li",[e._v("Er is een maximumaantal van twee subscribers. Voor kleine applicaties hoeft dit geen bezwaar te zijn, maar voor grotere applicaties die event-driven werken is dit niet voldoende.")]),e._v(" "),n("li",[e._v("De data in een stream is slechts voor 24 uur leesbaar.")]),e._v(" "),n("li",[e._v("Streams zijn gelimiteerd tot events die zijn uitgevoerd op de database tabel (CREATE, UPDATE, DELETE).")]),e._v(" "),n("li",[e._v("Geen .NET Core library beschikbaar met een implementatie van de Objecten. Een definitie van de JSON-objecten moet zelf worden geïmplementeerd.")])]),e._v(" "),n("h3",{attrs:{id:"simple-message-service"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#simple-message-service"}},[e._v("#")]),e._v(" Simple Message Service")]),e._v(" "),n("p",[n("a",{attrs:{href:"https://aws.amazon.com/sqs/pricing/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Amazon Simple Queue Service (SQS)"),n("OutboundLink")],1),e._v(" is een Message Queueing service die volledig beheerd wordt door Amazon Web Services. SQS biedt twee verschillende vormen van queues. De standaard queue biedt een maximale throughput (doorvoer) en zorgt ervoor dat elk bericht (minimaal) eenmaal wordt afgehandeld. FIFO-Queues (First-in-First-out) zijn specifiek ontworpen voor het eenmaal, op volgorde, afleveringen van berichten.")]),e._v(" "),n("h4",{attrs:{id:"voordelen-2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#voordelen-2"}},[e._v("#")]),e._v(" Voordelen")]),e._v(" "),n("ul",[n("li",[e._v("Implementatie van SQS zal herkenbaar zijn voor ontwikkelaars die eerder hebben gewerkt met een message broker zoals RabbitMQ of ActiveMQ.")]),e._v(" "),n("li",[e._v("Implementatie en integratie van SQS message queue’s is simpel. Er bestaan libraries in verscheidene talen (waaronder .NET Core) die het gebruik van de queue’s faciliteren, maar het is ook eenvoudig om zonder het gebruik van een library berichten naar een queue te sturen.")]),e._v(" "),n("li",[e._v("AWS Free tier biedt 1 miljoen SQS gratis per maand, iedere miljoen requests hierna kost rond de $0.40. Voor kleine applicaties kan SQS dus een goedkope optie zijn.")]),e._v(" "),n("li",[e._v("SQS schaalt automatisch, er is dus altijd voldoende capaciteit om je berichten te verwerken- en je betaalt nooit meer dan je verbruikt.")]),e._v(" "),n("li",[e._v("FIFO-Queues kunnen de volgorde van bezorging garanderen. Zo zullen events als eerst verstuurt ook als eerste verwerkt worden, dit is erg belangrijk voor een juiste implementatie van event sourcing.")])]),e._v(" "),n("h4",{attrs:{id:"aandachtspunten-3"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#aandachtspunten-3"}},[e._v("#")]),e._v(" Aandachtspunten")]),e._v(" "),n("ul",[n("li",[e._v("Wanneer een subscriber een bericht ontvangt uit de queue zal deze worden verwijderd. Het is dus niet mogelijk om hetzelfde bericht door meerdere subscribers te laten lezen. Als deze functionaliteit noodzakelijk is zal je het bericht naar verschillende queues moeten verzenden, ieder met zijn eigen subscriber.")]),e._v(" "),n("li",[e._v("Er is geen replay functionaliteit.")])]),e._v(" "),n("h3",{attrs:{id:"kinesis-data-streams"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#kinesis-data-streams"}},[e._v("#")]),e._v(" Kinesis Data streams")]),e._v(" "),n("p",[n("a",{attrs:{href:"https://aws.amazon.com/kinesis/data-streams/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Kinesis Data Streams"),n("OutboundLink")],1),e._v(" is een Amazon Web Service ontwikkelt voor het schaalbaar en real-time streamen van grote hoeveelheden data.")]),e._v(" "),n("p",[e._v("Een Kinesis data stream bestaat uit een set van "),n("em",[e._v("shards")]),e._v(", iedere "),n("em",[e._v("shard")]),e._v(" heeft zijn eigen geordende lijst met "),n("em",[e._v("data records")]),e._v(". Records in deze lijst krijgen een volgnummer toegewezen door Kinesis. Hierdoor kunnen we records altijd op de juiste volgorde uitlezen, maar is het hiervoor wel noodzakelijk dat records met hetzelfde "),n("em",[e._v("AggregateId")]),e._v(" naar dezelfde shard worden weggeschreven. Nadat records zijn toegevoegd aan een shard kunnen zij standaard voor 24 uur worden uitgelezen, maar het is mogelijk om dit (tegen extra kosten) te verlangen tot maximaal 7 dagen.")]),e._v(" "),n("h4",{attrs:{id:"voordelen-3"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#voordelen-3"}},[e._v("#")]),e._v(" Voordelen")]),e._v(" "),n("ul",[n("li",[e._v("Kinesis is specifiek ontwikkelt voor het real-time verzenden en verwerken van data.")]),e._v(" "),n("li",[e._v("Het op volgorde afspelen van berichten uit dezelfde shard werkt foutloos.")]),e._v(" "),n("li",[e._v("Kinesis is een "),n("em",[e._v("stream")]),e._v(", geen "),n("em",[e._v("queue")]),e._v(" (wachtrij) zoals SQS. Wanneer berichten zijn ontvangen door een consumer worden zij niet gelijk verwijderd. Hierdoor kunnen berichten ook opnieuw worden afgespeeld ("),n("em",[e._v("replay")]),e._v(") en afgehandeld door consumers.")]),e._v(" "),n("li",[e._v("Iedere stream kan tot 20 consumers hebben,")]),e._v(" "),n("li",[e._v("Berichten hebben een maximale grootte van 1MB.")]),e._v(" "),n("li",[e._v("Hoewel SQS goedkoop is voor applicaties met een kleiner volume, kunnen kosten snel stijgen wanneer dit volume toeneemt. Kinesis is juist het meest prijs effectief bij grootte hoeveelheden berichten.")]),e._v(" "),n("li",[n("a",{attrs:{href:"https://aws.amazon.com/kinesis/data-analytics/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Kinesis Data Analytics"),n("OutboundLink")],1),e._v(" biedt een eenvoudig oplossing voor het query-en op streaminggegevens met standaard SQL.")]),e._v(" "),n("li",[e._v("De "),n("em",[e._v("Kinesis Client Library")]),e._v(" maakt het gemakkelijk om applicaties te bouwen die werken met Kinesis Data Streams.")])]),e._v(" "),n("h4",{attrs:{id:"aandachtspunten-4"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#aandachtspunten-4"}},[e._v("#")]),e._v(" Aandachtspunten")]),e._v(" "),n("ul",[n("li",[e._v("Kinesis is schaalbaar doormiddel van shards. Er kunnen maximaal 1000 berichten per shard, per seconde worden weggeschreven. Het is mogelijk om honderden shard te reserveren, zodat er altijd voldoende capaciteit is. Maar hiervoor moet wel betaald worden, er moet dus een juiste afweging voor worden gemaakt.")])]),e._v(" "),n("h3",{attrs:{id:"welke-aws-service-is-het-meest-geschikt-als-event-bus"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#welke-aws-service-is-het-meest-geschikt-als-event-bus"}},[e._v("#")]),e._v(" Welke AWS-Service is het meest geschikt als Event Bus?")]),e._v(" "),n("p",[e._v("Ieder van de drie beschreven AWS-services zou een geschikte oplossing kunnen zijn als Event Bus. Dit ligt voornamelijk aan het type applicatie- en de bijbehorende eisen die deze heeft opgesteld voor de event bus. Cloudbash, de reference applicatie behorende bij dit artikel, is een applicatie die functionaliteiten omvat voor het verkopen van grootte getallen concert tickets. Het systeem werkt op basis van een event-driven architectuur waarbij grootte hoeveelheden berichten aan meerdere consumers moeten worden afgeleverd. Er is daarom gekozen gebruik te maken van "),n("strong",[e._v("Kinesis Data streams")]),e._v(". Deze service heeft als enige ondersteuning voor meerdere consumers. Ook maakt de persistence en replay functie van Kinesis het eenvoudig om berichten opnieuw af te spelen.")]),e._v(" "),n("h2",{attrs:{id:"read-database"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#read-database"}},[e._v("#")]),e._v(" Read Database")]),e._v(" "),n("h3",{attrs:{id:"dynamodb"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#dynamodb"}},[e._v("#")]),e._v(" DynamoDB")]),e._v(" "),n("h3",{attrs:{id:"elasticache"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#elasticache"}},[e._v("#")]),e._v(" ElastiCache")]),e._v(" "),n("h3",{attrs:{id:"relation-database-service-rds"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#relation-database-service-rds"}},[e._v("#")]),e._v(" Relation Database Service (RDS)")])])}),[],!1,null,null,null);a.default=r.exports}}]);